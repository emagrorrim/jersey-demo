version '1.0'

apply plugin: 'java'
apply plugin: 'war'
apply plugin: 'jetty'

sourceCompatibility = 1.8

repositories {
    mavenCentral()
}

dependencies {
    compile 'mysql:mysql-connector-java:5.1.37'
    compile 'org.mybatis:mybatis:3.3.0'
    compile 'org.glassfish.jersey.media:jersey-media-json-jackson:2.22.1'
    compile 'org.glassfish.jersey.containers:jersey-container-servlet:2.22.1'
    testCompile 'junit:junit:4.11'
    testCompile 'org.mockito:mockito-core:1.9.5'
}

task initDocker(type: Exec) {
    workingDir "script"
    commandLine "sh", "./setup_docker_container.sh"
}

task clearDocker(type: Exec) {
    workingDir "script"
    commandLine "sh", "./clear_docker_container.sh"
    ignoreExitValue true
}

task startServer(type: Exec) {
    workingDir "script"
    commandLine "sh", "./start.sh"
}

task stopServer(type: Exec) {
    workingDir "script"
    commandLine "sh", "./stop.sh"
}

initDocker.dependsOn build
initDocker.dependsOn clearDocker